(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d215c84"],{c056:function(s,a,t){"use strict";t.r(a);var n=function(){var s=this,a=s.$createElement;s._self._c;return s._m(0)},l=[function(){var s=this,a=s.$createElement,t=s._self._c||a;return t("div",{staticClass:"content"},[t("h3",{attrs:{id:"%E6%89%8B%E5%86%99promise"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#%E6%89%8B%E5%86%99promise"}}),s._v(" 手写Promise")]),t("pre",{staticClass:"hljs"},[t("code",[t("span",{staticClass:"hljs-comment"},[s._v("// 简易版")]),s._v("\n"),t("span",{staticClass:"hljs-function"},[t("span",{staticClass:"hljs-keyword"},[s._v("function")]),s._v(" "),t("span",{staticClass:"hljs-title"},[s._v("myPromis")]),s._v("("),t("span",{staticClass:"hljs-params"},[s._v("callback")]),s._v(") ")]),s._v("{\n        "),t("span",{staticClass:"hljs-keyword"},[s._v("this")]),s._v(".state = "),t("span",{staticClass:"hljs-string"},[s._v("'padding'")]),s._v("; "),t("span",{staticClass:"hljs-comment"},[s._v("// 初始状态值")]),s._v("\n        "),t("span",{staticClass:"hljs-keyword"},[s._v("this")]),s._v(".value = "),t("span",{staticClass:"hljs-literal"},[s._v("undefined")]),s._v("; "),t("span",{staticClass:"hljs-comment"},[s._v("// resolve状态")]),s._v("\n        "),t("span",{staticClass:"hljs-keyword"},[s._v("this")]),s._v(".reason = "),t("span",{staticClass:"hljs-literal"},[s._v("undefined")]),s._v("; "),t("span",{staticClass:"hljs-comment"},[s._v("// reject状态")]),s._v("\n        "),t("span",{staticClass:"hljs-keyword"},[s._v("let")]),s._v(" resolve = "),t("span",{staticClass:"hljs-function"},[t("span",{staticClass:"hljs-params"},[s._v("value")]),s._v(" =>")]),s._v(" {\n            "),t("span",{staticClass:"hljs-comment"},[s._v("// 保证转态改变是不可逆的")]),s._v("\n            "),t("span",{staticClass:"hljs-keyword"},[s._v("if")]),s._v(" ("),t("span",{staticClass:"hljs-keyword"},[s._v("this")]),s._v(".state === "),t("span",{staticClass:"hljs-string"},[s._v("'padding'")]),s._v(") {\n                "),t("span",{staticClass:"hljs-keyword"},[s._v("this")]),s._v(".state = "),t("span",{staticClass:"hljs-string"},[s._v("'fulfilled'")]),s._v(";\n                "),t("span",{staticClass:"hljs-keyword"},[s._v("this")]),s._v(".value = value;\n            }   \n        }   \n        "),t("span",{staticClass:"hljs-keyword"},[s._v("let")]),s._v(" reject = "),t("span",{staticClass:"hljs-function"},[t("span",{staticClass:"hljs-params"},[s._v("reason")]),s._v(" =>")]),s._v(" {\n            "),t("span",{staticClass:"hljs-comment"},[s._v("// 保证转态改变是不可逆的")]),s._v("\n            "),t("span",{staticClass:"hljs-keyword"},[s._v("if")]),s._v(" ("),t("span",{staticClass:"hljs-keyword"},[s._v("this")]),s._v(".state === "),t("span",{staticClass:"hljs-string"},[s._v("'padding'")]),s._v(") {\n                "),t("span",{staticClass:"hljs-keyword"},[s._v("this")]),s._v(".state = "),t("span",{staticClass:"hljs-string"},[s._v("'rejected'")]),s._v(";\n                "),t("span",{staticClass:"hljs-keyword"},[s._v("this")]),s._v(".value = reason;\n            }   \n        }\n        "),t("span",{staticClass:"hljs-comment"},[s._v("// 捕获异常")]),s._v("\n        "),t("span",{staticClass:"hljs-keyword"},[s._v("try")]),s._v(" {\n            callback(resolve, reject);\n        }"),t("span",{staticClass:"hljs-keyword"},[s._v("catch")]),s._v("(e){\n            reject(e);\n        }\n  \n}\nmyPromis.prototype.then = "),t("span",{staticClass:"hljs-function"},[t("span",{staticClass:"hljs-keyword"},[s._v("function")]),s._v("("),t("span",{staticClass:"hljs-params"},[s._v("onFulilled, onRejected")]),s._v(") ")]),s._v("{\n    "),t("span",{staticClass:"hljs-keyword"},[s._v("switch")]),s._v(" ("),t("span",{staticClass:"hljs-keyword"},[s._v("this")]),s._v(".state) {\n        "),t("span",{staticClass:"hljs-keyword"},[s._v("case")]),s._v(" "),t("span",{staticClass:"hljs-string"},[s._v("'fulfilled'")]),s._v(": \n            onFulilled("),t("span",{staticClass:"hljs-keyword"},[s._v("this")]),s._v(".value);\n            "),t("span",{staticClass:"hljs-keyword"},[s._v("break")]),s._v(";\n        "),t("span",{staticClass:"hljs-keyword"},[s._v("case")]),s._v(" "),t("span",{staticClass:"hljs-string"},[s._v("'rejected'")]),s._v(": \n            onRejected("),t("span",{staticClass:"hljs-keyword"},[s._v("this")]),s._v(".reason);\n            "),t("span",{staticClass:"hljs-keyword"},[s._v("break")]),s._v(";\n        "),t("span",{staticClass:"hljs-keyword"},[s._v("default")]),s._v(":\n    }\n}\n"),t("span",{staticClass:"hljs-keyword"},[s._v("let")]),s._v(" p = "),t("span",{staticClass:"hljs-keyword"},[s._v("new")]),s._v(" myPromis("),t("span",{staticClass:"hljs-function"},[s._v("("),t("span",{staticClass:"hljs-params"},[s._v("res, rej")]),s._v(") =>")]),s._v(" {\n"),t("span",{staticClass:"hljs-built_in"},[s._v("console")]),s._v(".log("),t("span",{staticClass:"hljs-number"},[s._v("1")]),s._v(");\nres("),t("span",{staticClass:"hljs-number"},[s._v("2")]),s._v(");\n});\np.then("),t("span",{staticClass:"hljs-function"},[s._v("("),t("span",{staticClass:"hljs-params"},[s._v("x")]),s._v(") =>")]),s._v(" {"),t("span",{staticClass:"hljs-built_in"},[s._v("console")]),s._v(".log(x)})\n")])])])}],e=t("2877"),v={},i=Object(e["a"])(v,n,l,!1,null,null,null);a["default"]=i.exports}}]);